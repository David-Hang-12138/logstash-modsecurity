input {
  file {
    # IMPORTANT! set this correctly to the charset
    # that your server writes these log files in
    path => "/var/log/sg_audit.log"
    type => "sense_guard"

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # merge all modsec events for a given entity into the same event.
    # so essentially the modsec -Z marker is used as the splitter
    # which is the end of each modsec logical event in the logfile
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    codec => multiline {
      charset => "US-ASCII"
      pattern => "^---[a-zA-Z0-9]{8}---Z--$"
      negate => true
      what => next
    }
  }
}
